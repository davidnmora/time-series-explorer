{"version":3,"sources":["images/county-wikipedia-fallback-image.jpg","images/cori-logo-black.png","general-ui/colors.js","general-ui/styles.js","dataConfig.js","data/utilsData.js","data-viz/line-chart/LineChart.js","data-viz/line-chart/RegionDataSection.js","data-viz/line-chart/LineChartsWithTitle.js","data/useCartoData.js","article-components/TimeSeriesScrollytelling.js","data-viz/state-level-time-series-chart/StateLevelTimeSeriesChart.js","data-viz/state-level-time-series-chart/chartAnnotations.js","article-components/StateLevelTimeSeriesScrollytelling.js","article-components/ArticleHeader.js","article-components/Footer.js","article-components/TextSections.js","mapConfig.js","data-viz/map/Map.js","data-viz/map/useResizeListener.js","mapStepsConfig.js","article-components/MapScrollytelling.js","App.js","index.js"],"names":["module","exports","COLORS","YEAR_COLORS","2018","2019","2020","TREND_COLORS","Boost","Plummet","CORI_COLORS","GlobalStyle","createGlobalStyle","HeadlineSection","styled","section","Headline","h1","Subtitle","p","marginBottom","TextSection","div","verticalPadding","Paragraph","LabelText","span","gray","hideOnMobile","ColoredText","color","FullBleedImage","img","MapBorderFade","bottom","WikipediaImage","isVisible","StateLevelTimeSeriesChartContainer","SVGContainer","svg","ScrollVizContainer","LineChartsWithTitleContainer","LineChartSection","GraphicContainer","ScrollContainer","width","StepWrapper","StepContent","dataConfig","MONTH_COLUMN","YEAR_COLUMN","TOTAL_SPEND_COVID_TREND","EATING_COVID_TREND","GROCERY_COVID_TREND","TOTAL_SPEND_COLUMN","TOTAL_SPEND_EATING","TOTAL_SPEND_GROCERY","REGION_COLUMN","DISPLAY_NAME_COLUMN","RURAL_PERCENTAGE_COLUMN","boost","equal","plummet","THUMBNAIL","NAME","TOTAL_POPULATION","round","num","decimalPlaces","Number","toFixed","smartDisplayValue","min","max","val","Math","abs","smartRound","nestDataByRegionAndYear","fetchedData","d3group","d","stateAverageByField","rollups","v","mean","year","month","map","title","coordinates","xVal","yVal","getShapedDataSets","dataByRegion","stateMonthlyAveragesByYear","getRegion","regionName","supplementaryCountyData","find","name","wikipediaThumbnailURL","getLineOpacity","lineData","dataColumn","visibleYears","maxYear","getLineColor","aPoint","trend","Line","scale","opacity","rest","path","d3line","x","y","numeric","pathGenerator","style","fill","strokeWidth","switchToCountyFallbackImage","error","target","src","COUNTY_FALLBACK_IMAGE","LineChart","regionDataByYear","screenWidth","window","innerWidth","chartWidth","dimensions","height","_regionDataByYear","values","filter","aDatum","includes","transitions","useTransition","from","strokeDashoffset","strokeOpacity","enter","leave","friction","mass","scaleLinear","range","domain","overflow","position","onError","length","alt","item","props","key","stroke","strokeDasharray","DATA_COLUMNS","RegionDataSection","dataColumns","ruralPercentLowerBound","aYearDatum","get","show","paddingTop","totalPopulation","display","LineChartsWithTitle","subtitle","filterField","match","keys","regionId","dataByRegionFilter","useCartoData","cartoTableName","fields","dataFormatter","data","dataB","dataA","DATA_SUBTITLE","STEPS_DATA","text","COUNTY_FIELDS_ARRAY","Object","TimeSeriesScrollytelling","classes","useState","state","setState","pad","onStepEnter","element","onStepExit","offset","stepData","i","StateLevelTimeSeriesChart","chartAnnotations","xLabel","yLabel","margin","left","right","top","lineStyle","axes","orient","label","locationDistance","responsiveWidth","responsiveHeight","baseFrameProps","xAccessor","yAccessor","annotations","lines","dateToInteger","monthNum","day","daysInMonth","FIRST_CASE","type","note","align","lineType","wrap","dy","dx","connector","end","STAY_AT_HOME_ORDER","className","bounds","StateLevelTimeSeriesScrollytelling","ArticleHeader","href","marginTop","fontSize","Footer","coriLogo","padding","IntroText","textAlign","TransitionOutOfStateWideChartText","PostLineChartsText","GrandTraverseImageAndText","IsabellaImageAndText","ConclusionText","mapConfig","MAPBOX_API_KEY","MAPBOX_STYLE_URL","MAPBOX_STYLE_ID","layers","BREWERIES","CHILD_CARE","POI","mapLocations","michigan","longitude","latitude","zoom","pitch","bearing","traverseCity","isabella","VIEWPORT_TRANSITION_PROPERTIES","transitionInterpolator","FlyToInterpolator","transitionEasing","easeQuadInOut","transitionDuration","DEFAULT_VIEWPORT","innerHeight","MAP_DEFAULT_SETTINGS","dragPan","dragRotate","scrollZoom","touchZoom","touchRotate","keyboard","doubleClickZoom","minZoom","maxZoom","navStyle","layerOpacityProps","line","circle","symbol","raster","Map","location","toggledOffLayers","viewport","setViewport","useEffect","mapboxStyleJSON","setMapboxStyleJSON","axios","then","current","updatedLayers","layer","opacityProps","id","paint","reduce","accumulator","opacityProp","setOpacity","handleViewportChange","useCallback","newViewport","resizeListener","addEventListener","removeEventListener","useResizeListener","onViewportChange","mapboxApiAccessToken","mapStyle","MAP_STEPS","MapScrollytelling","MRLI_FIELDS_ARRAY","App","HotReloadingApp","hot","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.89a6a362.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/county-wikipedia-fallback-image.8f0cf1e8.jpg\";","module.exports = __webpack_public_path__ + \"static/media/cori-logo-black.f1a2d150.png\";","export const COLORS = {\n  mystic: '#D8E8E8',\n  sinbad: '#A8D0DA',\n  sanMarino: '#406D96',\n  bluewood: '#2F3A56',\n  cinnibar: '#E2474B',\n  sunrise: '#dee45e',\n\n  greenApple: '#13c513',\n  gray: '#555',\n}\n\nexport const YEAR_COLORS = {\n  2018: COLORS.sinbad,\n  2019: COLORS.sanMarino,\n  2020: COLORS.cinnibar,\n}\n\nexport const TREND_COLORS = {\n  Boost: COLORS.greenApple,\n  Plummet: COLORS.cinnibar,\n  // Equal: COLORS.bluewood,\n}\nexport const CORI_COLORS = {\n  /*main*/\n  wheat: '#f2e1b7',\n  navy: '#092e39',\n\n  /*Gray scale*/\n  lightGray: '#dfdede',\n  mediumGray: '#7d7f7e',\n  black: '#1e1e1e',\n\n  /*colors*/\n  red: '#b62b2c',\n  blue: '#04476e',\n  maroon: '#551817',\n}\n","import styled, { createGlobalStyle } from 'styled-components'\nimport { CORI_COLORS } from './colors'\nconst MAXIMUM_MOBILE_SIZE = '800px'\n\nexport const GlobalStyle = createGlobalStyle`\n  body {\n    font-family: Rubik, sans-serif;\n    background-color: ${CORI_COLORS.lightGray};\n    color: ${CORI_COLORS.navy};\n  }\n`\n\nexport const HeadlineSection = styled.section`\n  max-width: 950px;\n  width: 95%;\n  z-index: 100;\n  position: relative;\n  margin: 144px auto;\n  @media only screen and (max-width: ${MAXIMUM_MOBILE_SIZE}) {\n    margin: 24px auto;\n  }\n`\n\nexport const Headline = styled.h1`\n  font-weight: 900;\n  font-size: 64px;\n  letter-spacing: -1px;\n  line-height: 1.2;\n  color: ${CORI_COLORS.navy};\n\n  @media only screen and (max-width: ${MAXIMUM_MOBILE_SIZE}) {\n    font-size: 36px;\n  }\n`\n\nexport const Subtitle = styled.p`\n  font-size: 24px;\n  font-weight: 400;\n  color: ${CORI_COLORS.black};\n  ${({ marginBottom }) => marginBottom && `margin-bottom: ${marginBottom};`}\n\n  @media only screen and (max-width: ${MAXIMUM_MOBILE_SIZE}) {\n    font-size: 16px;\n  }\n`\n\nexport const TextSection = styled.div`\n  margin: 0 auto;\n  padding: ${({ verticalPadding }) =>\n      verticalPadding ? `${verticalPadding}` : '0'}\n    0;\n  @media only screen and (max-width: ${MAXIMUM_MOBILE_SIZE}) {\n    padding: 12px 0;\n  }\n  max-width: 600px;\n  width: 95%;\n`\n\nexport const Paragraph = styled.p`\n  font-weight: 100;\n  color: ${CORI_COLORS.black};\n  font-size: 16px;\n  line-height: 1.6;\n`\n\nexport const LabelText = styled.span`\n  font-weight: 100;\n  color: ${({ gray }) => (gray ? CORI_COLORS.mediumGray : CORI_COLORS.black)};\n  font-size: ${({ gray }) => (gray ? '11' : '12')}px;\n  padding-right: 4px;\n\n  @media only screen and (max-width: ${MAXIMUM_MOBILE_SIZE}) {\n    font-size: ${({ gray }) => (gray ? '8' : '9')}px;\n    ${({ hideOnMobile }) => (hideOnMobile ? 'display: none;' : '')}\n  }\n`\n\nexport const ColoredText = styled.span`\n  color: ${({ color }) => `${color}`};\n`\n\nexport const FullBleedImage = styled.img`\n  width: 100vw;\n  margin: 36px 0;\n`\n\nexport const MapBorderFade = styled.div`\n  position: absolute;\n  ${({ bottom }) => (bottom ? 'bottom' : 'top')}: 0px;\n  left: 0px;\n  width: 100%;\n  height: 36px;\n\n  background: linear-gradient(\n    ${({ bottom }) => (bottom ? '0' : '180')}deg,\n    rgba(223, 222, 222, 1) 0%,\n    rgba(223, 222, 222, 0) 100%\n  );\n  z-index: 100;\n`\n\nexport const WikipediaImage = styled.img`\n  height: 100%;\n  width: 100%;\n  object-fit: cover;\n  opacity: ${({ isVisible }) => (isVisible ? 1 : 0)};\n  transition: opacity 1000ms;\n`\n\nexport const StateLevelTimeSeriesChartContainer = styled.div`\n  height: 90vh;\n  width: 90vw;\n  max-width: ${MAXIMUM_MOBILE_SIZE};\n  margin: 0 auto;\n  padding-top: 10vh;\n\n  & .tick-line {\n    opacity: 0.2;\n  }\n  & .stay-at-home-order .annotation-subject path {\n    fill: ${CORI_COLORS.maroon};\n    fill-opacity: 0.2;\n    stroke: none;\n  }\n`\n\nexport const SVGContainer = styled.svg`\n  position: absolute;\n  top: 0;\n  left: 0;\n`\n\nexport const ScrollVizContainer = styled.div`\n  display: flex;\n  position: sticky;\n  top: 0;\n  width: 100%;\n  pointer-events: all;\n\n  z-index: 0;\n`\n\nexport const LineChartsWithTitleContainer = styled.div`\n  margin: 36px;\n  @media only screen and (max-width: ${MAXIMUM_MOBILE_SIZE}) {\n    margin: 0;\n  }\n`\n\nexport const LineChartSection = styled.div`\n  display: flex;\n  flex-wrap: wrap;\n`\n\nexport const GraphicContainer = styled.div`\n  display: flex;\n  font-family: Rubik, sans-serif;\n  justify-content: space-between;\n`\n\nexport const ScrollContainer = styled.div`\n  //pointer-events: none; <- Todo: enable this so users can interact with the map. However, freezes touch screens (!?)\n  position: relative;\n  ${({ width }) => (width ? `width: ${width}; margin: auto;` : '')}\n`\n\nexport const StepWrapper = styled.div`\n  position: relative;\n  width: 100%;\n  //border: 1px dashed lightgray;\n  height: 80vh;\n  &:nth-child(2) {\n    margin-top: -75vh;\n  }\n  &:last-child {\n    margin-bottom: 50vh;\n  }\n  z-index: 10000;\n`\n\nexport const StepContent = styled.div`\n  width: 320px;\n  margin: 0 auto;\n  \n  padding: 24px;\n  border-radius: 5px;\n  box-shadow: 0 3px 3px 1px rgba(0,0,0,.11);\n  border: 1px solid #d0cccc;\n  \n  background: white;\n  \n  @media only screen and (max-width: ${MAXIMUM_MOBILE_SIZE}) {\n    width: 90vw;\n    margin: 0;\n    margin-left: 2.5vw;\n  }\n}\n`\n","export const dataConfig = {\n  ABBREV_STATE_NAME: 'MI',\n  MRLI_TIME_SERIES_TABLE: 'mrli_county_time_series',\n  MRLI_FIELDS: {\n    MONTH_COLUMN: 'month',\n    YEAR_COLUMN: 'year',\n    TOTAL_SPEND_COVID_TREND: 'retail_status',\n    EATING_COVID_TREND: 'eating_status',\n    GROCERY_COVID_TREND: 'grocery_status',\n    TOTAL_SPEND_COLUMN: 'total_spend_retail_categories_country_all_origins',\n    TOTAL_SPEND_EATING: 'total_spend_eating_places_country_all_origins',\n    TOTAL_SPEND_GROCERY:\n      'total_spend_grocery_and_food_stores_country_all_origins',\n    REGION_COLUMN: 'geoid',\n    DISPLAY_NAME_COLUMN: 'name',\n    RURAL_PERCENTAGE_COLUMN: 'rural_area_pct_usda',\n  },\n  trends: {\n    boost: 'Boost',\n    equal: 'Equal',\n    plummet: 'Plummet',\n  },\n  COUNTY_TABLE: 'attr_county_2018',\n  COUNTY_FIELDS: {\n    THUMBNAIL: 'thumb',\n    NAME: 'name',\n    TOTAL_POPULATION: 'total_population_2018',\n  },\n}\n","import { group as d3group, mean, rollups } from 'd3-array'\nimport { dataConfig } from '../dataConfig'\nimport { YEAR_COLORS } from '../general-ui/colors'\n\nexport const round = (num, decimalPlaces) => {\n  return +Number(num).toFixed(decimalPlaces)\n}\n\n// rounds to visually sensible decimal place\nexport const smartRound = (num = 0, min = false, max = false) => {\n  min = min || num\n  max = max || num\n  if (Math.abs(min) > 100 || Math.abs(max) > 100) return round(num, 0)\n  if (Math.abs(min) < 1 || Math.abs(max) < 1) return round(num, 3)\n  if (Math.abs(min) < 10 && Math.abs(max) < 10) return round(num, 2)\n  return round(num, 1)\n}\n\n// rounds to visually sensible decimal place\nexport const smartDisplayValue = (num, min, max) => {\n  if (typeof num === 'undefined' || num === null) return '-'\n  if (typeof num === 'string') return num\n\n  var val = smartRound(num, min || num, max || num)\n  if (Math.abs(val) > 1000000000000000)\n    return Math.round(val / 100000000000000) / 10.0 + 'Q'\n  if (Math.abs(val) > 1000000000000)\n    return Math.round(val / 100000000000) / 10.0 + 'T'\n  if (Math.abs(val) > 1000000000)\n    return Math.round(val / 100000000) / 10.0 + 'B'\n  if (Math.abs(val) > 1000000) return Math.round(val / 100000) / 10.0 + 'M'\n  if (Math.abs(val) > 1000) return Math.round(val / 100) / 10.0 + 'K'\n  if (Math.round(val) !== val) return Math.round(val * 10) / 10\n\n  return val\n}\n\nconst nestDataByRegionAndYear = (fetchedData) => {\n  return d3group(\n    fetchedData,\n    (d) => d[dataConfig.MRLI_FIELDS.REGION_COLUMN],\n    (d) => d[dataConfig.MRLI_FIELDS.YEAR_COLUMN]\n  )\n}\n\nconst stateAverageByField = (fetchedData) => {\n  const unformattedAverage = rollups(\n    fetchedData,\n    (v) => mean(v, (d) => d[dataConfig.MRLI_FIELDS.TOTAL_SPEND_COLUMN]),\n    (d) => d.year,\n    (d) => d.month\n  )\n  return unformattedAverage.map(([year, yearData]) => ({\n    title: year,\n    coordinates: yearData.map(([xVal, yVal]) => ({ xVal, yVal })),\n    color: YEAR_COLORS[year],\n  }))\n}\n\nexport const getShapedDataSets = (fetchedData) => ({\n  dataByRegion: nestDataByRegionAndYear(fetchedData),\n  stateMonthlyAveragesByYear: stateAverageByField(fetchedData),\n})\n\nconst getRegion = (regionName, supplementaryCountyData) =>\n  supplementaryCountyData.find(({ name }) => name === regionName) || {}\n\nexport const wikipediaThumbnailURL = (regionName, supplementaryCountyData) =>\n  getRegion(regionName, supplementaryCountyData)[\n    dataConfig.COUNTY_FIELDS.THUMBNAIL\n  ]\n\nexport const totalPopulation = (regionName, supplementaryCountyData) =>\n  smartDisplayValue(\n    getRegion(regionName, supplementaryCountyData)[\n      dataConfig.COUNTY_FIELDS.TOTAL_POPULATION\n    ]\n  )\n","import React from 'react'\nimport { line as d3line } from 'd3-shape'\nimport { scaleLinear } from 'd3-scale'\nimport { animated, useTransition } from 'react-spring'\nimport { SVGContainer, WikipediaImage } from '../../general-ui/styles'\nimport { dataConfig } from '../../dataConfig'\nimport { TREND_COLORS, YEAR_COLORS } from '../../general-ui/colors'\nimport { wikipediaThumbnailURL } from '../../data/utilsData'\nimport COUNTY_FALLBACK_IMAGE from '../../images/county-wikipedia-fallback-image.jpg'\n\nconst { MONTH_COLUMN, YEAR_COLUMN } = dataConfig.MRLI_FIELDS\nconst MAX_CHART_WIDTH = 144\n\nconst getLineOpacity = (lineData, dataColumn, visibleYears) => {\n  const aPoint = lineData[0]\n  const year = aPoint[YEAR_COLUMN]\n\n  const maxYear = Math.max(...visibleYears)\n  const shouldFadePreviousYears = maxYear === 2020 && year < maxYear\n  return shouldFadePreviousYears ? 0.5 : 1\n}\n\nconst getLineColor = (lineData, dataColumn) => {\n  const aPoint = lineData[0]\n  const year = aPoint[YEAR_COLUMN]\n\n  if (year === 2020) {\n    const trend = aPoint[dataColumn.trend]\n    return TREND_COLORS[trend]\n  }\n  return YEAR_COLORS[year]\n}\n\nconst Line = ({ lineData, dataColumn, scale, opacity, ...rest }) => {\n  const pathGenerator = d3line()\n    .x((d) => scale.x(d[MONTH_COLUMN]))\n    .y((d) => scale.y(d[dataColumn.numeric]))\n  const path = pathGenerator(lineData)\n\n  return (\n    <animated.path\n      d={path}\n      style={{\n        fill: 'none',\n        strokeWidth: 2,\n        opacity,\n      }}\n      {...rest}\n    />\n  )\n}\n\nconst switchToCountyFallbackImage = (error) =>\n  (error.target.src = COUNTY_FALLBACK_IMAGE)\n\nconst LineChart = ({\n  supplementaryCountyData,\n  regionName,\n  dataColumn,\n  visibleYears,\n  regionDataByYear,\n}) => {\n  const screenWidth = window.innerWidth\n  const chartWidth = Math.min(screenWidth * 0.1, MAX_CHART_WIDTH)\n  const dimensions = {\n    width: chartWidth,\n    height: chartWidth * 0.85,\n  }\n\n  const _regionDataByYear = [...regionDataByYear.values()].filter(\n    ([aDatum]) => !visibleYears || visibleYears.includes(aDatum[YEAR_COLUMN])\n  )\n  const transitions = useTransition(\n    _regionDataByYear,\n    ([aDatum]) => aDatum[YEAR_COLUMN],\n    {\n      from: {\n        strokeDashoffset: dimensions.width,\n        strokeOpacity: 0.8,\n      },\n      enter: {\n        strokeDashoffset: 0,\n        strokeOpacity: 1,\n      },\n      leave: { strokeOpacity: 0 },\n      friction: 500,\n      mass: 500,\n    }\n  )\n  const scale = {\n    x: scaleLinear().range([0, dimensions.width]).domain([1, 12]),\n    y: scaleLinear().range([dimensions.height, 0]).domain([0, 160]),\n  }\n\n  return (\n    <div style={{ overflow: 'hidden', position: 'relative', ...dimensions }}>\n      <WikipediaImage\n        src={wikipediaThumbnailURL(regionName, supplementaryCountyData)}\n        onError={switchToCountyFallbackImage}\n        isVisible={visibleYears.length === 0}\n        alt=\"Prominent location in the county pulled from Wikipedia\"\n      />\n      <SVGContainer\n        height={`${dimensions.height}px`}\n        width={`${dimensions.width}px`}\n      >\n        <g>\n          {transitions.map(({ item, props, key }) => (\n            <Line\n              key={key}\n              dataColumn={dataColumn}\n              lineData={item}\n              scale={scale}\n              stroke={getLineColor(item, dataColumn)}\n              opacity={getLineOpacity(item, dataColumn, visibleYears)}\n              strokeDasharray={dimensions.width}\n              {...props}\n            />\n          ))}\n        </g>\n      </SVGContainer>\n    </div>\n  )\n}\n\nexport default LineChart\n","import React from 'react'\nimport LineChart from './LineChart'\nimport { LabelText } from '../../general-ui/styles'\nimport { dataConfig } from '../../dataConfig'\nimport { totalPopulation } from '../../data/utilsData'\n\nconst {\n  DISPLAY_NAME_COLUMN,\n  TOTAL_SPEND_COLUMN,\n  TOTAL_SPEND_COVID_TREND,\n  // EATING_COVID_TREND,\n  // GROCERY_COVID_TREND,\n  // TOTAL_SPEND_EATING,\n  // TOTAL_SPEND_GROCERY,\n  RURAL_PERCENTAGE_COLUMN,\n} = dataConfig.MRLI_FIELDS\n\nconst DATA_COLUMNS = [\n  { numeric: TOTAL_SPEND_COLUMN, trend: TOTAL_SPEND_COVID_TREND },\n  // { numeric: TOTAL_SPEND_EATING, trend: EATING_COVID_TREND },\n  // { numeric: TOTAL_SPEND_GROCERY, trend: GROCERY_COVID_TREND },\n]\n\nconst RegionDataSection = ({\n  supplementaryCountyData,\n  regionDataByYear,\n  dataColumns = DATA_COLUMNS,\n  visibleYears = null,\n  ruralPercentLowerBound = 0,\n}) => {\n  const aYearDatum = regionDataByYear.get(\n    (visibleYears && visibleYears[0]) || 2020\n  )[0]\n  const regionName = aYearDatum[DISPLAY_NAME_COLUMN]\n  const show = aYearDatum[RURAL_PERCENTAGE_COLUMN] >= ruralPercentLowerBound\n  return (\n    <div style={{ opacity: show ? '1' : '0.1', paddingTop: 12 }}>\n      <LabelText>{regionName}</LabelText>\n      <LabelText gray>\n        {totalPopulation(regionName, supplementaryCountyData)}\n      </LabelText>\n      <div style={{ display: 'flex' }}>\n        {dataColumns.map((dataColumn) => (\n          <LineChart\n            key={`${regionName}-${dataColumn.numeric}`}\n            supplementaryCountyData={supplementaryCountyData}\n            regionName={regionName}\n            dataColumn={dataColumn}\n            visibleYears={visibleYears}\n            regionDataByYear={regionDataByYear}\n          />\n        ))}\n      </div>\n    </div>\n  )\n}\n\nexport default RegionDataSection\n","import React from 'react'\nimport {\n  LineChartsWithTitleContainer,\n  LineChartSection,\n  Subtitle,\n  LabelText,\n} from '../../general-ui/styles'\nimport { dataConfig } from '../../dataConfig'\nimport RegionDataSection from './RegionDataSection'\n\nconst dataByRegionFilter = (dataByRegion, filterField, match) =>\n  [...dataByRegion.keys()].filter(\n    (regionId) => dataByRegion.get(regionId).get(2020)[0][filterField] === match\n  )\n\nexport const LineChartsWithTitle = ({\n  supplementaryCountyData,\n  dataByRegion,\n  title,\n  subtitle,\n  trend,\n  visibleYears,\n  ruralPercentLowerBound,\n}) => (\n  <LineChartsWithTitleContainer>\n    <Subtitle marginBottom=\"0\">{title}</Subtitle>\n    <LabelText gray hideOnMobile>\n      {subtitle}\n    </LabelText>\n    <LineChartSection>\n      {dataByRegionFilter(\n        dataByRegion,\n        dataConfig.MRLI_FIELDS.TOTAL_SPEND_COVID_TREND,\n        trend\n      ).map((regionId) => (\n        <RegionDataSection\n          key={regionId}\n          supplementaryCountyData={supplementaryCountyData}\n          visibleYears={visibleYears}\n          regionDataByYear={dataByRegion.get(regionId)}\n          ruralPercentLowerBound={ruralPercentLowerBound || 0}\n        />\n      ))}\n    </LineChartSection>\n  </LineChartsWithTitleContainer>\n)\n","import dataB from '../data/hardCodedDataB.json'\nimport dataA from '../data/hardCodedDataA.json'\n\nconst useCartoData = (\n  cartoTableName,\n  fields,\n  sqlFilter = '',\n  dataFormatter = (data) => data,\n  defaultValue = []\n) => {\n  // hardcoded so we don't rely on CORI's server, which may change\n  if (cartoTableName === 'mrli_county_time_series') {\n    return dataFormatter(dataB)\n  } else {\n    return dataFormatter(dataA)\n  }\n}\n\nexport default useCartoData\n","import React, { useState } from 'react'\nimport { Scrollama, Step } from 'react-scrollama'\nimport {\n  ScrollVizContainer,\n  GraphicContainer,\n  ScrollContainer,\n  StepWrapper,\n  StepContent,\n  ColoredText,\n} from '../general-ui/styles'\nimport { LineChartsWithTitle } from '../data-viz/line-chart/LineChartsWithTitle'\nimport { dataConfig } from '../dataConfig'\nimport { YEAR_COLORS } from '../general-ui/colors'\nimport { TREND_COLORS } from '../general-ui/colors'\nimport useCartoData from '../data/useCartoData'\n\nconst DATA_SUBTITLE =\n  'Data is a total consumer spending index normalized against a fixed, historic, national average.'\n\nconst STEPS_DATA = [\n  {\n    visibleYears: [],\n    text:\n      \"Of Michigan's 83 counties, these 30 experienced significant spending changes.\",\n  },\n  {\n    visibleYears: [2018],\n    text: (\n      <>\n        This is the overall consumer spending index across{' '}\n        <ColoredText color={YEAR_COLORS['2018']}>2018</ColoredText> and from\n        January to December.\n      </>\n    ),\n  },\n  {\n    visibleYears: [2018, 2019],\n    text: (\n      <>\n        Overall consumer spending changed little between{' '}\n        <ColoredText color={YEAR_COLORS['2018']}>2018</ColoredText> and{' '}\n        <ColoredText color={YEAR_COLORS['2019']}>2019</ColoredText>.\n      </>\n    ),\n  },\n  {\n    visibleYears: [2018, 2019, 2020],\n    text: (\n      <>\n        As COVID struck, counties saw unprecedented relative{' '}\n        <ColoredText color={TREND_COLORS[dataConfig.trends.boost]}>\n          growth\n        </ColoredText>{' '}\n        and{' '}\n        <ColoredText color={TREND_COLORS[dataConfig.trends.plummet]}>\n          decrease\n        </ColoredText>\n        .\n      </>\n    ),\n  },\n  {\n    visibleYears: [2018, 2019, 2020],\n    text: (\n      <>\n        Removing urban counties, we see that most relative{' '}\n        <ColoredText color={TREND_COLORS[dataConfig.trends.boost]}>\n          growth\n        </ColoredText>{' '}\n        happened in rural counties, with two notable exceptions:{' '}\n        <ColoredText color={TREND_COLORS[dataConfig.trends.plummet]}>\n          Grand Traverse & Isabella county\n        </ColoredText>\n        .\n      </>\n    ),\n    ruralPercentLowerBound: 50,\n  },\n]\n\nconst COUNTY_FIELDS_ARRAY = Object.values(dataConfig.COUNTY_FIELDS)\n\nexport const TimeSeriesScrollytelling = ({ classes, dataByRegion }) => {\n  const supplementaryCountyData = useCartoData(\n    dataConfig.COUNTY_TABLE,\n    COUNTY_FIELDS_ARRAY,\n    `WHERE  st_stusps = '${dataConfig.ABBREV_STATE_NAME}'`\n  )\n  const [state, setState] = useState({ data: STEPS_DATA[0] })\n\n  const onStepEnter = ({ element, data }) => {\n    element.style.opacity = 1\n    setState({ ...state, data })\n  }\n\n  const onStepExit = ({ element }) => {\n    element.style.opacity = 0.7\n  }\n\n  if (!dataByRegion || ![...dataByRegion.keys()].length) return null\n\n  return (\n    <GraphicContainer>\n      <ScrollContainer width=\"95vw\">\n        <ScrollVizContainer pad>\n          <LineChartsWithTitle\n            supplementaryCountyData={supplementaryCountyData}\n            dataByRegion={dataByRegion}\n            title={\n              <>\n                Counties that{' '}\n                <ColoredText color={TREND_COLORS[dataConfig.trends.boost]}>\n                  grew\n                </ColoredText>{' '}\n                during COVID-19\n              </>\n            }\n            subtitle={DATA_SUBTITLE}\n            trend={dataConfig.trends.boost}\n            ruralPercentLowerBound={state.data.ruralPercentLowerBound}\n            visibleYears={state.data.visibleYears}\n          />\n          <LineChartsWithTitle\n            supplementaryCountyData={supplementaryCountyData}\n            dataByRegion={dataByRegion}\n            title={\n              <>\n                Counties that{' '}\n                <ColoredText color={TREND_COLORS[dataConfig.trends.plummet]}>\n                  decreased\n                </ColoredText>{' '}\n                during COVID-19\n              </>\n            }\n            subtitle={DATA_SUBTITLE}\n            trend={dataConfig.trends.plummet}\n            ruralPercentLowerBound={state.data.ruralPercentLowerBound}\n            visibleYears={state.data.visibleYears}\n          />\n        </ScrollVizContainer>\n\n        <Scrollama\n          onStepEnter={onStepEnter}\n          onStepExit={onStepExit}\n          offset={0.7}\n        >\n          {STEPS_DATA.map((stepData, i) => (\n            <Step data={stepData} key={i}>\n              <StepWrapper>\n                <StepContent>\n                  <p>{stepData.text}</p>\n                </StepContent>\n              </StepWrapper>\n            </Step>\n          ))}\n        </Scrollama>\n      </ScrollContainer>\n    </GraphicContainer>\n  )\n}\n","import React from 'react'\nimport ResponsiveXYFrame from 'semiotic/lib/ResponsiveXYFrame'\nimport { StateLevelTimeSeriesChartContainer } from '../../general-ui/styles'\n\nconst baseFrameProps = (xLabel, yLabel) => ({\n  margin: { left: 80, bottom: 90, right: 10, top: 40 },\n  lineStyle: (d) => ({\n    stroke: d.color,\n    strokeWidth: 2,\n    fill: 'none',\n  }),\n  axes: [\n    {\n      orient: 'left',\n      label: yLabel,\n    },\n    {\n      orient: 'bottom',\n      label: { name: xLabel, locationDistance: 55 },\n    },\n  ],\n\n  responsiveWidth: true,\n  responsiveHeight: true,\n})\n\nexport const StateLevelTimeSeriesChart = ({\n  data,\n  visibleYears,\n  chartAnnotations = [],\n  xLabel,\n  yLabel,\n}) => (\n  <StateLevelTimeSeriesChartContainer>\n    <ResponsiveXYFrame\n      {...baseFrameProps(xLabel, yLabel)}\n      xAccessor={'xVal'}\n      yAccessor={'yVal'}\n      annotations={chartAnnotations}\n      lines={data.filter(({ title }) => visibleYears.includes(title))}\n    />\n  </StateLevelTimeSeriesChartContainer>\n)\n","const dateToInteger = (monthNum, day = 0, daysInMonth = 31) =>\n  `${monthNum + day / daysInMonth}`\n\nexport const FIRST_CASE = {\n  type: 'x',\n  xVal: dateToInteger(3, 10, 31), // March 10\n  note: {\n    label: 'First case',\n    align: 'middle',\n    lineType: null,\n    wrap: 100,\n  },\n  // color: CORI_COLORS.maroon,\n  dy: -12,\n  dx: 0,\n  connector: { end: 'none' },\n}\n\nexport const STAY_AT_HOME_ORDER = {\n  className: 'stay-at-home-order',\n  type: 'bounds',\n  bounds: [\n    { xVal: dateToInteger(3, 24, 31) },\n    { xVal: dateToInteger(5, 28, 31) },\n  ],\n  label: 'Stay at home order',\n  dx: 96,\n  // color: CORI_COLORS.maroon,\n}\n","import React, { useState } from 'react'\nimport { Scrollama, Step } from 'react-scrollama'\nimport {\n  ScrollVizContainer,\n  GraphicContainer,\n  ScrollContainer,\n  StepWrapper,\n  StepContent,\n  ColoredText,\n} from '../general-ui/styles'\nimport { StateLevelTimeSeriesChart } from '../data-viz/state-level-time-series-chart/StateLevelTimeSeriesChart'\nimport { YEAR_COLORS } from '../general-ui/colors'\nimport {\n  FIRST_CASE,\n  STAY_AT_HOME_ORDER,\n} from '../data-viz/state-level-time-series-chart/chartAnnotations'\n\nconst STEPS_DATA = [\n  {\n    visibleYears: [2018],\n    text: (\n      <>\n        This is the overall consumer spending index across{' '}\n        <ColoredText color={YEAR_COLORS['2018']}>2018</ColoredText> and from\n        January to December.\n      </>\n    ),\n  },\n  {\n    visibleYears: [2018, 2019],\n    text: (\n      <>\n        Overall consumer spending grew between{' '}\n        <ColoredText color={YEAR_COLORS['2018']}>2018</ColoredText> and{' '}\n        <ColoredText color={YEAR_COLORS['2019']}>2019</ColoredText>.\n      </>\n    ),\n  },\n  {\n    visibleYears: [2018, 2019, 2020],\n    chartAnnotations: [FIRST_CASE],\n    text: (\n      <>\n        But, as COVID struck in{' '}\n        <ColoredText color={YEAR_COLORS['2020']}>2020</ColoredText>, Michigan\n        saw unprecedented drop in spending relative to the national average.\n      </>\n    ),\n  },\n  {\n    visibleYears: [2018, 2019, 2020],\n    chartAnnotations: [FIRST_CASE, STAY_AT_HOME_ORDER],\n    text:\n      'Between March 24th and May 28th, Michigan Governor Gretchen Whitmer put in place some of the strictest stay-at-home orders in the nation, further impacting spend.',\n  },\n]\n\nexport const StateLevelTimeSeriesScrollytelling = ({\n  stateMonthlyAveragesByYear,\n}) => {\n  const [state, setState] = useState({ data: STEPS_DATA[0] })\n\n  const onStepEnter = ({ element, data }) => {\n    element.style.opacity = 1\n    setState({ ...state, data })\n  }\n\n  const onStepExit = ({ element }) => {\n    element.style.opacity = 0.7\n  }\n\n  if (!stateMonthlyAveragesByYear) return null\n\n  return (\n    <GraphicContainer>\n      <ScrollContainer width=\"95vw\">\n        <ScrollVizContainer pad>\n          <StateLevelTimeSeriesChart\n            data={stateMonthlyAveragesByYear}\n            visibleYears={state.data.visibleYears}\n            chartAnnotations={state.data.chartAnnotations}\n            xLabel=\"Month\"\n            yLabel=\"Average total spend\"\n          />\n        </ScrollVizContainer>\n\n        <Scrollama\n          onStepEnter={onStepEnter}\n          onStepExit={onStepExit}\n          offset={0.7}\n        >\n          {STEPS_DATA.map((stepData, i) => (\n            <Step data={stepData} key={i}>\n              <StepWrapper>\n                <StepContent>\n                  <p>{stepData.text}</p>\n                </StepContent>\n              </StepWrapper>\n            </Step>\n          ))}\n        </Scrollama>\n      </ScrollContainer>\n    </GraphicContainer>\n  )\n}\n","import React from 'react'\nimport { HeadlineSection, Headline, Subtitle } from '../general-ui/styles'\n\nconst ArticleHeader = () => (\n  <>\n    <HeadlineSection>\n      <Headline>COVID-19 & rural Michigan consumer spending</Headline>\n      <Subtitle>\n        How COVID is shifting the landscape of rural spending in surprising\n        ways, and what it means for long-term resilience.\n      </Subtitle>\n      Visual design, dataviz, story and code by David Mora for{' '}\n      <a href=\"https://ruralinnovation.us/\">The Center on Rural Innovation</a>{' '}\n      <div style={{ marginTop: 12, fontSize: 8 }}>\n        Note: actual data has been replaced with comparable placeholders\n      </div>\n    </HeadlineSection>\n  </>\n)\n\nexport default ArticleHeader\n","import React from 'react'\nimport { TextSection } from '../general-ui/styles'\n\nimport coriLogo from '../images/cori-logo-black.png'\n\nexport const Footer = () => (\n  <TextSection style={{ height: 160 }}>\n    <img\n      src={coriLogo}\n      alt=\"Center on Rural Innovation\"\n      style={{ width: 180, padding: 8 }}\n    />\n  </TextSection>\n)\n","import {\n  Subtitle,\n  Paragraph,\n  TextSection,\n  FullBleedImage,\n} from '../general-ui/styles'\nimport React from 'react'\n\nconst TRAVERSE_CITY_IMAGE =\n  'https://images.squarespace-cdn.com/content/v1/56a8596376d99c0164fc16bd/1578445792801-5BSVWMDMUVWLSHD2AA8R/ke17ZwdGBToddI8pDm48kETsGhw5V0vaG2_dPXh0k_sUqsxRUqqbr1mOJYKfIPR7LoDQ9mXPOjoJoqy81S2I8N_N4V1vUb5AoIIIbLZhVYy7Mythp_T-mtop-vrsUOmeInPi9iDjx9w8K4ZfjXt2dgSTPdVqrdB2uNKPeP1zvLmaV_5iISfNi78mEzwocAj4G6v6ULRah83RgHXAWD5lbQ/TRAVERSE_CITY_MI_DESTINATION4.jpg?format=2500w'\n\nconst ISABELLA_IMAGE =\n  'https://www.kidsquest.com/wp-content/uploads/2017/06/Soaring-hotel-exterior-3.jpg'\n\nexport const IntroText = ({ verticalPadding }) => (\n  <TextSection verticalPadding={verticalPadding}>\n    <Paragraph>\n      We all know COVID-19 has radically shifted consumer spending habits.\n    </Paragraph>\n    <Paragraph>\n      But how is this affecting rural areas? And what does it reveal about the\n      strengths and the needs of these areas?\n    </Paragraph>\n    <Paragraph>\n      With support and data from Partner, we're able to take a near real-time\n      look at how these questions play out across Michigan.\n    </Paragraph>\n    <Paragraph>\n      To begin, let's take a big picture look at the overall consumer spending\n      at a state level for 2018 and 2019, then compare that to COVID-19's impact\n      on 2020.\n    </Paragraph>\n\n    <div style={{ textAlign: 'center', marginTop: 24 }}>\n      Scroll to advance the story ↓\n    </div>\n  </TextSection>\n)\n\nexport const TransitionOutOfStateWideChartText = ({ verticalPadding }) => (\n  <TextSection verticalPadding={verticalPadding}>\n    <Paragraph>\n      However, when you look at counties, trends vary widely.\n    </Paragraph>\n    <Paragraph>\n      To understand this variance, let's contrast counties who've experienced a\n      significant growth or decrease in 2020.\n    </Paragraph>\n\n    <div style={{ textAlign: 'center', marginTop: 24 }}>\n      Scroll to advance the story ↓{' '}\n    </div>\n  </TextSection>\n)\n\nexport const PostLineChartsText = () => (\n  <TextSection>\n    <Subtitle>\n      Why were Grand Traverse & Isabella the only rural counties which saw a\n      relative decrease?\n    </Subtitle>\n    <Paragraph>Let's investigate...</Paragraph>\n  </TextSection>\n)\n\nexport const GrandTraverseImageAndText = () => (\n  <>\n    <FullBleedImage src={TRAVERSE_CITY_IMAGE} alt=\"Traverse city bay\" />\n    <TextSection verticalPadding=\"112px\">\n      <Subtitle>Grand Traverse County</Subtitle>\n      <Paragraph>\n        Grand Traverse County's county seat is Traverse City. It has a\n        population of approximately 92k.\n      </Paragraph>\n      <Paragraph>\n        The focal point of the county is Traverse City (in the photo above),\n        whose wide reaching tourism is on hold during COVID-19.\n      </Paragraph>\n    </TextSection>\n  </>\n)\n\nexport const IsabellaImageAndText = () => (\n  <>\n    <FullBleedImage\n      src={ISABELLA_IMAGE}\n      alt=\"Soaring Eagle Casino and Resort\"\n    />\n    <TextSection verticalPadding=\"112px\">\n      <Subtitle>Isabella County</Subtitle>\n      <Paragraph>\n        Isabella county has a population of approximately 70k. Isabella County's\n        2 largest employers are Soaring Eagle Casino and Central Michigan\n        University, both of which have significantly slowed during COVID-19.\n      </Paragraph>\n      <Paragraph>\n        For more context, let's visit Grand Traverse county and Isabella county\n        on the map...\n      </Paragraph>\n    </TextSection>\n  </>\n)\n\nexport const ConclusionText = () => (\n  <TextSection verticalPadding=\"112px\">\n    <Paragraph>\n      Wrapping up, Partner's data lets us spot near real-time trends in\n      spending, highlighting where to deploy our own rural-focused data to fill\n      in the larger picture.\n    </Paragraph>\n    <Paragraph>\n      This is just the start. We're eager to use data and our on-the-ground\n      expertise to help rural America respond to the COVID-19 pandemic.\n    </Paragraph>\n  </TextSection>\n)\n","export const mapConfig = {\n  MAPBOX_API_KEY:\n    'pk.eyJ1IjoicnVyYWxpbm5vIiwiYSI6ImNqeHl0cW0xODBlMm0zY2x0dXltYzRuazUifQ.zZBovoCHzLIW0wCZveEKzA',\n  MAPBOX_STYLE_URL: 'mapbox://styles/ruralinno/cka5wv42k00361ipehpyhe6v7/draft',\n  MAPBOX_STYLE_ID: 'cka5wv42k00361ipehpyhe6v7',\n  layers: {\n    BREWERIES: 'Breweries',\n    CHILD_CARE: 'Child Care',\n    POI: 'poi-label',\n  },\n  mapLocations: {\n    michigan: {\n      longitude: -84.81596,\n      latitude: 44.82781,\n      zoom: 6.29,\n      pitch: 26.0,\n      bearing: 0.0,\n    },\n    traverseCity: {\n      longitude: -85.61616,\n      latitude: 44.74203,\n      zoom: 13.35,\n      pitch: 57.5,\n      bearing: -0.23,\n    },\n    isabella: {\n      longitude: -84.77129,\n      latitude: 43.60072,\n      zoom: 13.62,\n      pitch: 60.0,\n      bearing: 113.6,\n    },\n  },\n}\n","import React, { useState, useEffect, useCallback } from 'react'\nimport axios from 'axios'\nimport ReactMapGL, {\n  FlyToInterpolator /*NavigationControl*/,\n} from 'react-map-gl'\nimport { easeQuadInOut } from 'd3-ease'\nimport { MapBorderFade } from '../../general-ui/styles'\nimport { useResizeListener } from './useResizeListener'\nimport { mapConfig } from '../../mapConfig'\n\nconst MAP_PAN_TRANSITION_DURATION = 4000\nconst VIEWPORT_TRANSITION_PROPERTIES = {\n  transitionInterpolator: new FlyToInterpolator(),\n  transitionEasing: easeQuadInOut,\n  transitionDuration: MAP_PAN_TRANSITION_DURATION,\n}\n\nconst DEFAULT_VIEWPORT = {\n  ...VIEWPORT_TRANSITION_PROPERTIES,\n  width: window.innerWidth,\n  height: window.innerHeight,\n}\n\nexport const MAP_DEFAULT_SETTINGS = {\n  dragPan: false,\n  dragRotate: false,\n  scrollZoom: false,\n  touchZoom: false,\n  touchRotate: false,\n  keyboard: false,\n  doubleClickZoom: false,\n  minZoom: 3,\n  maxZoom: 24, // Note: this IS the maximum possible zoom\n}\n\nconst navStyle = {\n  position: 'absolute',\n  bottom: 76,\n  right: 0,\n  padding: '10px',\n}\n\nconst layerOpacityProps = {\n  fill: ['fill-opacity'],\n  line: ['line-opacity'],\n  circle: ['circle-opacity', 'circle-stroke-opacity'],\n  symbol: ['icon-opacity', 'text-opacity'],\n  raster: ['raster-opacity'],\n  'fill-extrusion': ['fill-extrusion-opacity'],\n}\n\nexport const Map = ({\n  location = mapConfig.mapLocations.michigan,\n  toggledOffLayers = [],\n}) => {\n  const [viewport, setViewport] = useState({\n    ...DEFAULT_VIEWPORT,\n    ...location,\n  })\n\n  useEffect(\n    () =>\n      setViewport({\n        ...DEFAULT_VIEWPORT,\n        ...location,\n      }),\n    [location, toggledOffLayers, setViewport]\n  )\n\n  const [mapboxStyleJSON, setMapboxStyleJSON] = useState(null)\n  useEffect(() => {\n    axios\n      .get(\n        `https://api.mapbox.com/styles/v1/ruralinno/${mapConfig.MAPBOX_STYLE_ID}?access_token=${mapConfig.MAPBOX_API_KEY}`\n      )\n      .then(({ data }) => setMapboxStyleJSON(data))\n  }, [setMapboxStyleJSON])\n\n  const setOpacity = (opacityProps, layer, opacity) =>\n    opacityProps.reduce(\n      (accumulator, opacityProp) => ({\n        ...accumulator,\n        [opacityProp]: opacity,\n      }),\n      layer.paint\n    )\n\n  useEffect(() => {\n    setMapboxStyleJSON((current) => {\n      if (!current) return current\n\n      const updatedLayers = current.layers.map((layer) => {\n        const opacityProps = layerOpacityProps[layer.type] || []\n        if (Object.values(mapConfig.layers).includes(layer.id)) {\n          layer.paint = setOpacity(\n            opacityProps,\n            layer,\n            toggledOffLayers.includes(layer.id) ? 0 : 1\n          )\n        }\n        return layer\n      })\n\n      return { ...current, layers: updatedLayers }\n    })\n  }, [toggledOffLayers, setMapboxStyleJSON])\n\n  const handleViewportChange = useCallback(\n    (newViewport = {}) =>\n      setViewport({\n        ...DEFAULT_VIEWPORT,\n        ...viewport,\n        ...newViewport,\n        width: window.innerWidth,\n        height: window.innerHeight,\n      }),\n    [viewport]\n  )\n\n  const resizeListener = useCallback(() => handleViewportChange(), [\n    handleViewportChange,\n  ])\n  useResizeListener(resizeListener)\n\n  if (!mapboxStyleJSON) return null\n\n  return (\n    <div className=\"map\" style={{ position: 'relative' }}>\n      <MapBorderFade />\n      <ReactMapGL\n        {...MAP_DEFAULT_SETTINGS}\n        {...DEFAULT_VIEWPORT}\n        {...viewport}\n        onViewportChange={handleViewportChange}\n        mapboxApiAccessToken={mapConfig.MAPBOX_API_KEY}\n        mapStyle={mapboxStyleJSON}\n      >\n        <div style={navStyle}>\n          {/*<NavigationControl showCompass={false} />*/}\n        </div>\n      </ReactMapGL>\n      <MapBorderFade bottom />\n    </div>\n  )\n}\n","import { useEffect } from 'react'\n\nexport const useResizeListener = (resizeListener) => {\n  useEffect(() => {\n    window.addEventListener('resize', resizeListener)\n    return () => window.removeEventListener('resize', resizeListener)\n  }, [resizeListener])\n}\n","import { mapConfig } from './mapConfig'\n\nexport const MAP_STEPS = [\n  {\n    location: mapConfig.mapLocations.michigan,\n    text: 'Welcome to Michigan!',\n    toggledOffLayers: [\n      mapConfig.layers.BREWERIES,\n      mapConfig.layers.CHILD_CARE,\n      mapConfig.layers.POI,\n    ],\n  },\n  {\n    location: mapConfig.mapLocations.traverseCity,\n    text: 'This is Traverse City, the heart of Grand Traverse County',\n    toggledOffLayers: [\n      mapConfig.layers.BREWERIES,\n      mapConfig.layers.CHILD_CARE,\n      mapConfig.layers.POI,\n    ],\n  },\n  {\n    location: mapConfig.mapLocations.traverseCity,\n    text: '... and a hotspot for breweries',\n    toggledOffLayers: [\n      // mapConfig.layers.BREWERIES,\n      mapConfig.layers.CHILD_CARE,\n      mapConfig.layers.POI,\n    ],\n  },\n  {\n    location: mapConfig.mapLocations.traverseCity,\n    text: '... and strong childcare to support a thriving workforce',\n    toggledOffLayers: [\n      // mapConfig.layers.BREWERIES,\n      // mapConfig.layers.CHILD_CARE,\n      mapConfig.layers.POI,\n    ],\n  },\n  {\n    location: mapConfig.mapLocations.isabella,\n    text: 'Welcome to Isabella County!',\n    toggledOffLayers: [\n      mapConfig.layers.BREWERIES,\n      mapConfig.layers.CHILD_CARE,\n      mapConfig.layers.POI,\n    ],\n  },\n  {\n    location: mapConfig.mapLocations.isabella,\n    text: '... which sports many POIs.',\n    toggledOffLayers: [\n      // mapConfig.layers.BREWERIES,\n      // mapConfig.layers.CHILD_CARE,\n      // mapConfig.layers.POI,\n    ],\n  },\n]\n","import React, { useState } from 'react'\nimport {\n  ScrollVizContainer,\n  GraphicContainer,\n  ScrollContainer,\n  StepWrapper,\n  StepContent,\n} from '../general-ui/styles'\nimport { Scrollama, Step } from 'react-scrollama'\nimport { Map } from '../data-viz/map/Map'\nimport { MAP_STEPS } from '../mapStepsConfig'\n\nexport const MapScrollytelling = () => {\n  const [state, setState] = useState({ data: MAP_STEPS[0] })\n\n  const onStepEnter = ({ element, data }) => {\n    element.style.opacity = 1\n    setState({ ...state, data })\n  }\n\n  const onStepExit = ({ element }) => {\n    element.style.opacity = 0.7\n  }\n\n  return (\n    <GraphicContainer>\n      <ScrollContainer>\n        <ScrollVizContainer>\n          <Map\n            location={state.data.location}\n            toggledOffLayers={state.data.toggledOffLayers}\n          />\n        </ScrollVizContainer>\n\n        <Scrollama\n          onStepEnter={onStepEnter}\n          onStepExit={onStepExit}\n          offset={0.7}\n        >\n          {MAP_STEPS.map((stepData, i) => (\n            <Step data={stepData} key={i}>\n              <StepWrapper>\n                <StepContent>\n                  <p>{stepData.text}</p>\n                </StepContent>\n              </StepWrapper>\n            </Step>\n          ))}\n        </Scrollama>\n      </ScrollContainer>\n    </GraphicContainer>\n  )\n}\n","import React from 'react'\nimport 'antd/dist/antd.css'\nimport 'mapbox-gl/dist/mapbox-gl.css'\nimport { TimeSeriesScrollytelling } from './article-components/TimeSeriesScrollytelling'\nimport { StateLevelTimeSeriesScrollytelling } from './article-components/StateLevelTimeSeriesScrollytelling'\nimport useCartoData from './data/useCartoData'\nimport ArticleHeader from './article-components/ArticleHeader'\nimport { Footer } from './article-components/Footer'\nimport {\n  ConclusionText,\n  IntroText,\n  PostLineChartsText,\n  GrandTraverseImageAndText,\n  IsabellaImageAndText,\n  TransitionOutOfStateWideChartText,\n} from './article-components/TextSections'\nimport { MapScrollytelling } from './article-components/MapScrollytelling'\nimport { dataConfig } from './dataConfig'\nimport { getShapedDataSets } from './data/utilsData'\n\nconst MRLI_FIELDS_ARRAY = Object.values(dataConfig.MRLI_FIELDS)\n\nfunction App() {\n  const { dataByRegion, stateMonthlyAveragesByYear } = useCartoData(\n    dataConfig.MRLI_TIME_SERIES_TABLE,\n    MRLI_FIELDS_ARRAY,\n    `ORDER BY ${dataConfig.MRLI_FIELDS.MONTH_COLUMN}`,\n    getShapedDataSets,\n    {}\n  )\n\n  return (\n    <div className=\"App\">\n      <ArticleHeader />\n\n      <IntroText verticalPadding={'0'} />\n\n      <StateLevelTimeSeriesScrollytelling\n        stateMonthlyAveragesByYear={stateMonthlyAveragesByYear}\n      />\n      <TransitionOutOfStateWideChartText verticalPadding={'48px'} />\n\n      <TimeSeriesScrollytelling dataByRegion={dataByRegion} />\n      <PostLineChartsText />\n\n      <GrandTraverseImageAndText />\n      <IsabellaImageAndText />\n      <MapScrollytelling />\n\n      <ConclusionText />\n      <Footer />\n    </div>\n  )\n}\n\nexport default App\n","import { hot } from 'react-hot-loader/root'\nimport React from 'react'\nimport ReactDOM from 'react-dom'\nimport App from './App'\nimport { GlobalStyle } from './general-ui/styles'\n\nconst HotReloadingApp = hot(() => (\n  <>\n    <App />\n    <GlobalStyle />\n  </>\n))\nReactDOM.render(<HotReloadingApp />, document.getElementById('root'))\n"],"sourceRoot":""}